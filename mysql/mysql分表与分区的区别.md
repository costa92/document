# MySQL 的分表与分区的区别

## 什么是分表

什么是分表：分表是将一个大表按照一定的规则分解成多张具有独立储存空间实体表，每一个表都对应三个文件：**MYD数据文件**、**MYI 索引文件**、FRM 表结构文件。分表的数据可以分布在同一个磁盘是，也可以在不同的机器上，只需要在访问数据读写的时候根据事先的规则，操作相对应的数据表。

分表又分为：**水平分表**  和 **垂直分表**

**水平分表**：一般使用 hash、取模等方式进行拆分，可以将100 百万的用户表，拆分几个独立的表，注意：**表的结构一定要是一样的，只有表的名字不一样，但是名表名一定是规律的，不能随便命名，否则会增加编码的难度**，在操作业务的时候通过一定规则（hash 、取模等）进行规则来读写到相应的表中。

![image-20210719213956922](https://file.longqiuhong.com/markdown/image-20210719213956922.png)



**垂直分表**： 垂直分表是数据列的拆分，把一张列表多得表拆分为多个表，通常按照一下原则来进行垂直拆分：

1、不常用的字段单独放在一个表

2、把 text、blob(binary larage object,二进制大对象)等大字段拆分到附属表，

3、组合查询的列放同一个表

按照字段的大小来拆分：

![image-20210719220141973](https://file.longqiuhong.com/markdown/image-20210719220141973.png)

分表自定义规则：

**Range（范围）–**这种模式允许将数据划分不同范围。例如可以将一个表通过年份划分成若干个分区。
**Hash（哈希）–**这中模式允许通过对表的一个或多个列的Hash Key进行计算，最后通过这个Hash码不同数值对应的数据区域进行分区。例如可以建立一个对表主键进行分区的表。
**Key（键值）–**上面Hash模式的一种延伸，这里的Hash Key是MySQL系统产生的。
**List（预定义列表）–**这种模式允许系统通过预定义的列表的值来对数据进行分割。
**Composite（复合模式）**  以上模式的组合使用　

##  什么是分区

什么是分区：分区与分表相似，都是按照规则来分解表。不同在于分表是将大表拆分成若干个独立的实体表，而分区只是将数据分段划分在多个位置存放，可以是同一块磁盘也可以在不同的机器。分区后，表面上还是一张表，但数据散列到多个位置。 读写的时候还是操作大表的名字，db自动去组织分区。

分区的几种方式：

**Range （范围）**

**List （列表）**

**Hash （哈希）**

**Key   (键值)**

## 分表与分区有什么联系

1、都能提高 MySQL的性能，在高并发状态下都有良好的表现

2、分表和分区不矛盾，可以相互配合使用，对于大访问量，并且数据比较多的表，可以采取分表和分区结合使用，访问量不大，但是表数据很多得表，可以采用分区的方式

3、分表技术是比较麻烦的，需要手动去创建子表，业务读写的是需要计算子表名。但可以采用 merge 表， 不过需要创建子表与配置子表的 union 的关系。

4、分区对于分表，操作方便，不需要创建子表。